<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>₿AZAR TCM — автообъявления</title>
<style>
:root{--accent:#0b6efd;--bg:#f5f7f8;--card:#fff;--muted:#666;--radius:10px;--gap:16px;}
*{box-sizing:border-box} body{margin:0;font-family:Inter,Arial,sans-serif;background:var(--bg);color:#222;-webkit-font-smoothing:antialiased;}
header{background:linear-gradient(90deg,var(--accent),#1466d6);color:#fff;padding:18px 20px;display:flex;gap:12px;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:30;}
.brand{display:flex;gap:10px;align-items:center;font-weight:700;font-size:18px;}
.brand .logo{width:44px;height:44px;border-radius:8px;background:rgba(255,255,255,0.12);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:18px;}
.search{flex:1;max-width:760px;display:flex;gap:8px;}
.search input{flex:1;padding:10px 12px;border-radius:8px;border:none;outline:none;}
.search button{background:#fff;border:none;color:var(--accent);padding:10px 14px;border-radius:8px;font-weight:600;cursor:pointer;}
.wrap{padding:20px;max-width:1200px;margin:0 auto;display:grid;grid-template-columns:320px 1fr;gap:var(--gap);}
@media(max-width:900px){ .wrap{grid-template-columns:1fr; padding:12px;} header{flex-wrap:wrap;} .search{max-width:none;width:100%} }
.panel{background:var(--card);padding:14px;border-radius:var(--radius);box-shadow:0 6px 18px rgba(12,20,40,0.06);position:relative;}
.panel h3{margin:0 0 10px;font-size:16px}
.field{margin-bottom:10px} label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px} select,input[type="number"],input[type="text"]{width:100%;padding:8px 10px;border-radius:6px;border:1px solid #e6eef8}
.row{display:flex;gap:8px} .small{flex:1} .checkboxes{display:flex;flex-wrap:wrap;gap:8px} .chip{padding:6px 8px;border-radius:8px;background:#f1f6ff;border:1px solid #e6f0ff;font-size:13px;cursor:pointer} .chip.active{background:linear-gradient(180deg,#dbeaff,#c9e0ff);border-color:#a6c8ff}
.actions{display:flex;gap:8px;margin-top:8px} .btn{flex:1;padding:10px;border-radius:8px;border:none;background:var(--accent);color:white;font-weight:700;cursor:pointer} .btn.ghost{background:#f3f7fb;color:var(--muted);border:1px solid #e6eef8}
.results-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;gap:12px} .sort{display:flex;gap:8px;align-items:center} .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:16px}
.card{background:var(--card);border-radius:12px;padding:10px;box-shadow:0 6px 18px rgba(12,20,40,0.05);overflow:hidden;display:flex;flex-direction:column;}
.thumb{width:100%;height:140px;border-radius:10px;overflow:hidden;margin-bottom:8px;background:#efefef;display:flex;align-items:center;justify-content:center;color:#999;font-weight:600;}
.meta{display:flex;justify-content:space-between;align-items:center;gap:8px} .title{font-weight:700;font-size:15px} .price{color:#0a8d3b;font-weight:800} .badges{display:flex;gap:6px;flex-wrap:wrap;margin-top:8px} .badge{background:#f3f7fb;border-radius:8px;padding:6px 8px;font-size:12px;color:#444} .muted{color:var(--muted);font-size:13px}
.empty{padding:40px;border-radius:10px;text-align:center;color:var(--muted);background:#fff}
.mb8{margin-bottom:8px}
</style>
</head>
<body>

<header>
<div class="brand"><div class="logo">₿</div><div>₿AZAR <span style="opacity:0.9;margin-left:6px;font-weight:600">TCM</span></div></div>
<div class="search" role="search">
<input id="q" placeholder="Поиск: марка, модель, цвет..." />
<button id="btnSearch">Найти</button>
</div>
<div style="min-width:140px;text-align:right;color:#fff;font-size:13px">Рынок автомобилей</div>
</header>

<main class="wrap">
<aside class="panel" aria-label="Фильтры">
<h3>Фильтры</h3>
<div class="field"><label>Марка</label><select id="filterBrand"><option value="">— Все марки —</option></select></div>
<div class="field"><label>Модель</label><input id="filterModel" type="text" placeholder="Введите модель (частично)" /></div>
<div class="field"><label>Цена (сом)</label><div class="row"><input id="priceMin" class="small" type="number" placeholder="От" min="0" /><input id="priceMax" class="small" type="number" placeholder="До" min="0" /></div></div>
<div class="field"><label>Цвет</label><div class="checkboxes" id="colors"></div></div>
<div class="field"><label>Состояние</label>
<div class="checkboxes">
<label class="chip" data-val="new"><input type="radio" name="state" value="" style="display:none"> Все</label>
<label class="chip" data-val="new"><input type="radio" name="state" value="new" style="display:none"> Новый</label>
<label class="chip" data-val="used"><input type="radio" name="state" value="used" style="display:none"> С пробегом</label>
</div></div>
<div class="field"><label>Тип кузова</label><div class="checkboxes" id="bodies"></div></div>
<div class="actions"><button id="apply" class="btn">Применить</button><button id="clear" class="btn ghost">Сбросить</button></div>
<div style="margin-top:12px;font-size:13px;color:var(--muted)">Показано <strong id="count">0</strong> объявления(й)</div>
</aside>

<section>
<div class="panel" style="padding:12px 14px 16px;">
<div class="results-header">
<div><strong id="resultsTitle">Последние объявления</strong><div class="muted" style="font-size:13px">— Автомобили</div></div>
<div class="sort">
<label class="muted" style="font-size:13px;margin-right:6px">Сортировать:</label>
<select id="sortBy"><option value="recent">Свежее</option><option value="price-asc">Цена ↑</option><option value="price-desc">Цена ↓</option></select>
</div>
</div>
<div id="grid" class="grid"></div>
<div id="empty" class="empty" style="display:none;margin-top:12px">Объявления не найдены — попробуйте изменить фильтры</div>
</div>
</section>
</main>

<script>
const ADS=[{id:1,brand:"Toyota",model:"Camry",price:1250000,currency:"сом",color:"Белый",condition:"used",body:"Седан",year:2017,km:85000,photo:null},{id:2,brand:"Hyundai",model:"Solaris",price:690000,currency:"сом",color:"Серебристый",condition:"used",body:"Седан",year:2015,km:120000,photo:null},{id:3,brand:"Mercedes",model:"C180",price:4200000,currency:"сом",color:"Чёрный",condition:"used",body:"Седан",year:2019,km:45000,photo:null},{id:4,brand:"Kia",model:"Rio",price:730000,currency:"сом",color:"Красный",condition:"used",body:"Хэтчбек",year:2018,km:70000,photo:null},{id:5,brand:"BMW",model:"Z4",price:5800000,currency:"сом",color:"Синий",condition:"new",body:"Купе",year:2024,km:0,photo:null},{id:6,brand:"Lada",model:"Vesta",price:420000,currency:"сом",color:"Белый",condition:"used",body:"Седан",year:2016,km:90000,photo:null},{id:7,brand:"Audi",model:"A5",price:3600000,currency:"сом",color:"Чёрный",condition:"used",body:"Купе",year:2018,km:65000,photo:null},{id:8,brand:"Mazda",model:"CX-5",price:1450000,currency:"сом",color:"Белый",condition:"new",body:"Внедорожник",year:2025,km:0,photo:null}];

const elBrand=document.getElementById('filterBrand'),elColors=document.getElementById('colors'),elBodies=document.getElementById('bodies'),elGrid=document.getElementById('grid'),elCount=document.getElementById('count'),elQ=document.getElementById('q'),elModel=document.getElementById('filterModel'),elMin=document.getElementById('priceMin'),elMax=document.getElementById('priceMax'),elSort=document.getElementById('sortBy'),elEmpty=document.getElementById('empty');

(function populate(){
const brands=[...new Set(ADS.map(a=>a.brand))].sort();
brands.forEach(b=>{const o=document.createElement('option');o.value=b;o.textContent=b;elBrand.appendChild(o);});
const colors=[...new Set(ADS.map(a=>a.color))].sort();
colors.forEach(c=>{const chip=document.createElement('label');chip.className='chip';chip.innerHTML=`<input type="checkbox" value="${c}" style="display:none" /> ${c}`;chip.addEventListener('click',()=>{const cb=chip.querySelector('input');cb.checked=!cb.checked;chip.classList.toggle('active',cb.checked)});elColors.appendChild(chip);});
const bodies=[...new Set(ADS.map(a=>a.body))].sort();
bodies.forEach(b=>{const chip=document.createElement('label');chip.className='chip';chip.innerHTML=`<input type="checkbox" value="${b}" style="display:none" /> ${b}`;chip.addEventListener('click',()=>{const cb=chip.querySelector('input');cb.checked=!cb.checked;chip.classList.toggle('active',cb.checked)});elBodies.appendChild(chip);});
document.querySelectorAll('.panel .chip').forEach(ch=>{ch.addEventListener('click',()=>{const radios=ch.querySelectorAll('input[type="radio"]');if(radios.length){document.querySelectorAll('.panel .chip').forEach(x=>{if(x.querySelector('input[type="radio"]')) x.classList.remove('active');});ch.classList.add('active');radios[0].checked=true;}});});
})();

function getFilters(){const brand=elBrand.value,model=elModel.value.trim().toLowerCase(),q=elQ.value.trim().toLowerCase(),min=Number(elMin.value)||0,max=Number(elMax.value)||Infinity;colorChecks=[...elColors.querySelectorAll('input[type="checkbox"]:checked')].map(i=>i.value);bodyChecks=[...elBodies.querySelectorAll('input[type="checkbox"]:checked')].map(i=>i.value);let state="";document.querySelectorAll('.panel input[type="radio"]').forEach(r=>{if(r.checked) state=r.value;});return{brand,model,q,min,max,colors:colorChecks,bodies:bodyChecks,state};}

function applyFilters(){const f=getFilters();let res=ADS.slice();if(f.brand) res=res.filter(a=>a.brand===f.brand);if(f.model) res=res.filter(a=>a.model.toLowerCase().includes(f.model));if(f.q) res=res.filter(a=>(a.brand+' '+a.model+' '+(a.description||'')+' '+a.color).toLowerCase().includes(f.q));res=res.filter(a=>a.price>=f.min&&a.price<=f.max);if(f.colors.length) res=res.filter(a=>f.colors.includes(a.color));if(f.bodies.length) res=res.filter(a=>f.bodies.includes(a.body));if(f.state) res=res.filter(a=>a.condition===f.state);const sort=elSort.value;if(sort==='price-asc') res.sort((x,y)=>x.price-y.price);else if(sort==='price-desc') res.sort((x,y)=>y.price-x.price);else res.sort((x,y)=>y.id-y.id);renderGrid(res);}

function renderGrid(items){elGrid.innerHTML='';elCount.textContent=items.length;if(!items.length){elEmpty.style.display='block';return;}else elEmpty.style.display='none';items.forEach(ad=>{const card=document.createElement('div');card.className='card';const thumb=document.createElement('div');thumb.className='thumb';thumb.textContent=ad.photo?ad.photo:ad.brand+' '+ad.model;const title=document.createElement('div');title.className='title';title.textContent=`${ad.brand} ${ad.model} • ${ad.year||''}`;const meta=document.createElement('div');meta.className='meta';const price=document.createElement('div');price.className='price';price.textContent=formatPrice(ad.price)+' '+(ad.currency||'');const cond=document.createElement('div');cond.className='muted';cond.textContent=ad.condition==='new'?'Новый':`Пробег ${ad.km?ad.km+' км':''}`;const desc=document.createElement('div');desc.className='muted';desc.style.marginTop='8px';desc.textContent=`${ad.color} • ${ad.body}`;const badges=document.createElement('div');badges.className='badges';const b1=document.createElement('div');b1.className='badge';b1.textContent=ad.color;const b2=document.createElement('div');b2.className='badge';b2.textContent=ad.body;badges.append(b1,b2);card.appendChild(thumb);card.appendChild(title);meta.appendChild(price);meta.appendChild(cond);card.appendChild(meta);card.appendChild(desc);card.appendChild(badges);const foot=document.createElement('div');foot.style.cssText='margin-top:10px;display:flex;gap:8px;';const view=document.createElement('button');view.className='btn ghost';view.style.padding='8px 10px';view.textContent='Посмотреть';view.onclick=()=>window.location.href=`details.html?id=${ad.id}`;const contact=document.createElement('button');contact.className='btn';contact.style.padding='8px 10px';contact.textContent='Связаться';contact.onclick=()=>window.open('https://t.me/BazarTcmBot','_blank');foot.appendChild(view);foot.appendChild(contact);card.appendChild(foot);elGrid.appendChild(card);});}

function formatPrice(n){return String(n).replace(/\B(?=(\d{3})+(?!\d))/g," ");}

document.getElementById('apply').addEventListener('click',applyFilters);
document.getElementById('clear').addEventListener('click',()=>{elBrand.value='';elModel.value='';elQ.value='';elMin.value='';elMax.value='';document.querySelectorAll('#colors input,#bodies input').forEach(i=>{i.checked=false;i.parentElement.classList.remove('active');});document.querySelectorAll('.panel input[type="radio"]').forEach(r=>r.checked=false);document.querySelectorAll('.panel .chip').forEach(c=>{if(!c.querySelector('input[type="checkbox"]'))c.classList.remove('active');});applyFilters();});
document.getElementById('btnSearch').addEventListener('click',applyFilters);
elSort.addEventListener('change',applyFilters);
[elQ,elModel].forEach(inp=>inp.addEventListener('keydown',e=>{if(e.key==='Enter')applyFilters();}));
applyFilters();
</script>

</body>
</html>
